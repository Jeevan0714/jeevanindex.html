<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Smart Farming Assistant</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f9f0;
      margin: 0;
      padding: 1rem;
      color: #2d4a2d;
    }
    header {
      text-align: center;
      margin-bottom: 1rem;
      position: relative;
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 0.2rem;
    }
    /* Adjust language-select positioning and width */
    .language-select {
      position: absolute;
      top: 0;
      right: 0;
      margin: 1rem;
      font-size: 1rem;
      background: #d4edda;
      border: 2px solid #28a745;
      border-radius: 8px;
      padding: 0.3rem 0.6rem;
      color: #2d4a2d;
      cursor: pointer;
      width: 2cm; /* approx 2 cm width */
      box-sizing: border-box;
    }
    .instructions {
      background: #d4edda;
      border: 2px solid #28a745;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    select, input[type="number"] {
      width: 100%;
      padding: 0.5rem;
      font-size: 1rem;
      margin-top: 0.3rem;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      margin-top: 1rem;
      background-color: #28a745;
      color: white;
      border: none;
      padding: 1rem;
      font-size: 1.2rem;
      border-radius: 8px;
      width: 100%;
      cursor: pointer;
    }
    button:disabled {
      background-color: #a5d6a7;
      cursor: not-allowed;
    }
    .voice-btn {
      background-color: #2d7a2d;
      margin-top: 0.5rem;
    }
    .footer {
      text-align: center;
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #555;
    }
  </style>
</head>
<body>
  <header>
    <h1 id="header-title">Smart Farming Assistant</h1>
    <p id="header-subtitle">Get simple, crop-specific advice based on sensor data</p>
    <select id="languageSelect" class="language-select" aria-label="Select Language">
      <option value="en">English</option>
      <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
    </select>
  </header>

  <section>
    <label for="crop" id="label-crop">Select Crop:</label>
    <select id="crop" aria-label="Select Crop">
      <option value="" id="option-choose-crop">-- Choose your crop --</option>
      <option value="maize" id="option-maize">Maize</option>
      <option value="rice" id="option-rice">Rice</option>
      <option value="beans" id="option-beans">Beans</option>
      <option value="tomato" id="option-tomato">Tomato</option>
    </select>

    <label for="soilMoisture" id="label-soilMoisture">Soil Moisture (%):</label>
    <input type="number" id="soilMoisture" min="0" max="100" placeholder="Enter soil moisture" />

    <label for="soilNutrients" id="label-soilNutrients">Soil Nutrients (NPK level):</label>
    <input type="number" id="soilNutrients" min="0" max="100" placeholder="Enter nutrient level" />
    
    <!-- New Temperature input field -->
    <label for="temperature" id="label-temperature">Temperature (¬∞C):</label>
    <input type="number" id="temperature" min="-10" max="60" placeholder="Enter temperature" />

    <label for="weather" id="label-weather">Local Weather Condition:</label>
    <select id="weather" aria-label="Select Weather Condition">
      <option value="" id="option-select-weather">-- Select weather --</option>
      <option value="dry" id="option-dry">Dry</option>
      <option value="rainy" id="option-rainy">Rainy</option>
      <option value="cloudy" id="option-cloudy">Cloudy</option>
      <option value="sunny" id="option-sunny">Sunny</option>
    </select>

    <button id="getAdviceBtn" disabled>Get Advice</button>
    <button id="speakBtn" class="voice-btn" disabled>üîä Listen to Advice</button>

    <div class="instructions" id="advice" aria-live="polite" role="region" style="display:none;"></div>
  </section>

  <footer class="footer" id="footer-text">
    &copy; 2024 Smart Farming Assistant
  </footer>

  <script>
    const translations = {
      kn: {
        "header-title": "‡≤∏‡≥ç‡≤Æ‡≤æ‡≤∞‡≥ç‡≤ü‡≥ç ‡≤ï‡≥É‡≤∑‡≤ø ‡≤∏‡≤π‡≤æ‡≤Ø‡≤ï",
        "header-subtitle": "‡≤∏‡≥Ü‡≤®‡≥ç‡≤∏‡≤∞‡≥ç ‡≤°‡≥á‡≤ü‡≤æ‡≤¶ ‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤∏‡≤∞‡≤≥, ‡≤¨‡≥Ü‡≤≥‡≥Ü-‡≤®‡≤ø‡≤∞‡≥ç‡≤¶‡≤ø‡≤∑‡≥ç‡≤ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤≥‡≥Å ‡≤™‡≤°‡≥Ü‡≤Ø‡≤ø‡≤∞‡≤ø",
        "label-crop": "‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø:",
        "option-choose-crop": "-- ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø --",
        "option-maize": "‡≤Æ‡≥Ü‡≤ï‡≥ç‡≤ï‡≥Ü‡≤ú‡≥ã‡≤≥",
        "option-rice": "‡≤®‡≥Ä‡≤∞‡≥Å‡≤π‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å",
        "option-beans": "‡≤¨‡≥Ä‡≤®‡≥ç‡≤∏‡≥ç",
        "option-tomato": "‡≤ü‡≥ä‡≤Æ‡≥á‡≤ü‡≥ã",
        "label-soilMoisture": "‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂ (%):",
        "soilMoisture": "‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂ ‡≤®‡≤Æ‡≥Ç‡≤¶‡≤ø‡≤∏‡≤ø",
        "label-soilNutrients": "‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ã‡≤∑‡≤ï‡≤æ‡≤Ç‡≤∂ (NPK ‡≤Æ‡≤ü‡≥ç‡≤ü):",
        "soilNutrients": "‡≤™‡≥ã‡≤∑‡≤ï‡≤æ‡≤Ç‡≤∂ ‡≤Æ‡≤ü‡≥ç‡≤ü ‡≤®‡≤Æ‡≥Ç‡≤¶‡≤ø‡≤∏‡≤ø",
        "label-temperature": "‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤® (¬∞C):",
        "temperature": "‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤® ‡≤®‡≤Æ‡≥Ç‡≤¶‡≤ø‡≤∏‡≤ø",
        "label-weather": "‡≤∏‡≥ç‡≤•‡≤≥‡≥Ä‡≤Ø ‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤∏‡≥ç‡≤•‡≤ø‡≤§‡≤ø:",
        "option-select-weather": "-- ‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø --",
        "option-dry": "‡≤¨‡≤ø‡≤≤‡≥ç‡≤≤‡≥Å",
        "option-rainy": "‡≤Æ‡≤≥‡≥Ü‡≤Ø‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü",
        "option-cloudy": "‡≤Æ‡≥á‡≤ò‡≤æ‡≤µ‡≥É‡≤§",
        "option-sunny": "‡≤¨‡≥Ü‡≤≥‡≤ó‡≤ø‡≤® ‡≤π‡≥ä‡≤§‡≥ç‡≤§‡≤ø‡≤®‡≤≤‡≥ç‡≤≤‡≤ø",
        "getAdviceBtn": "‡≤∏‡≤≤‡≤π‡≥Ü ‡≤™‡≤°‡≥Ü‡≤Ø‡≤ø‡≤∞‡≤ø",
        "speakBtn": "üîä ‡≤∏‡≤≤‡≤π‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø",
        "footer-text": "¬© 2024 ‡≤∏‡≥ç‡≤Æ‡≤æ‡≤∞‡≥ç‡≤ü‡≥ç ‡≤ï‡≥É‡≤∑‡≤ø ‡≤∏‡≤π‡≤æ‡≤Ø‡≤ï"
      },
      en: {
        "header-title": "Smart Farming Assistant",
        "header-subtitle": "Get simple, crop-specific advice based on sensor data",
        "label-crop": "Select Crop:",
        "option-choose-crop": "-- Choose your crop --",
        "option-maize": "Maize",
        "option-rice": "Rice",
        "option-beans": "Beans",
        "option-tomato": "Tomato",
        "label-soilMoisture": "Soil Moisture (%):",
        "soilMoisture": "Enter soil moisture",
        "label-soilNutrients": "Soil Nutrients (NPK level):",
        "soilNutrients": "Enter nutrient level",
        "label-temperature": "Temperature (¬∞C):",
        "temperature": "Enter temperature",
        "label-weather": "Local Weather Condition:",
        "option-select-weather": "-- Select weather --",
        "option-dry": "Dry",
        "option-rainy": "Rainy",
        "option-cloudy": "Cloudy",
        "option-sunny": "Sunny",
        "getAdviceBtn": "Get Advice",
        "speakBtn": "üîä Listen to Advice",
        "footer-text": "¬© 2024 Smart Farming Assistant"
      }
    };

    const languageSelect = document.getElementById('languageSelect');
    const cropSelect = document.getElementById('crop');
    const soilMoistureInput = document.getElementById('soilMoisture');
    const soilNutrientsInput = document.getElementById('soilNutrients');
    const temperatureInput = document.getElementById('temperature');
    const weatherSelect = document.getElementById('weather');
    const getAdviceBtn = document.getElementById('getAdviceBtn');
    const adviceDiv = document.getElementById('advice');
    const speakBtn = document.getElementById('speakBtn');

    function updateLanguageTexts(lang) {
      for (const id in translations[lang]) {
        const elem = document.getElementById(id);
        if (elem) {
          if (elem.tagName.toLowerCase() === 'input') {
            elem.placeholder = translations[lang][id];
          } else if (elem.tagName.toLowerCase() === 'option') {
            elem.textContent = translations[lang][id];
          } else if (elem.tagName.toLowerCase() === 'button') {
            elem.textContent = translations[lang][id];
          } else {
            elem.textContent = translations[lang][id];
          }
        }
      }
    }

    languageSelect.addEventListener('change', () => {
      const lang = languageSelect.value;
      updateLanguageTexts(lang);
      validateInputs();
      adviceDiv.style.display = 'none';
      speakBtn.disabled = true;
    });

    function validateInputs() {
      if (
        cropSelect.value &&
        soilMoistureInput.value !== '' &&
        soilNutrientsInput.value !== '' &&
        temperatureInput.value !== '' &&
        weatherSelect.value
      ) {
        getAdviceBtn.disabled = false;
      } else {
        getAdviceBtn.disabled = true;
        speakBtn.disabled = true;
        adviceDiv.style.display = 'none';
      }
    }

    cropSelect.addEventListener('change', validateInputs);
    soilMoistureInput.addEventListener('input', validateInputs);
    soilNutrientsInput.addEventListener('input', validateInputs);
    temperatureInput.addEventListener('input', validateInputs);
    weatherSelect.addEventListener('change', validateInputs);

    function generateAdvice() {
      const lang = languageSelect.value;
      const crop = cropSelect.value;
      const moisture = parseInt(soilMoistureInput.value, 10);
      const nutrients = parseInt(soilNutrientsInput.value, 10);
      const temperature = parseInt(temperatureInput.value, 10);
      const weather = weatherSelect.value;

      const adv_en = {
        water_low: 'Soil moisture is low. Water your crop today for 15 minutes. ',
        water_high: 'Soil moisture is high. Avoid watering to prevent waterlogging. ',
        water_ok: 'Soil moisture is adequate. No watering needed now. ',
        nutrient_low: 'Soil nutrients are low. Apply fertilizer according to crop needs. ',
        nutrient_ok: 'Soil nutrients are sufficient. No fertilization needed now. ',
        temp_low: 'Temperature is low. Protect plants from cold conditions. ',
        temp_high: 'Temperature is high. Provide shade or irrigation to reduce heat stress. ',
        temp_ok: 'Temperature is within the optimal range for growth. ',
        weather_rainy: 'Rain is expected. Delay watering and check for pests after rain. ',
        weather_dry: 'Dry weather expected. Monitor soil moisture closely. ',
        crop_notes: {
          maize: 'Maize requires regular monitoring during growth stages.',
          rice: 'Rice fields need careful water management.',
          beans: 'Beans benefit from balanced fertilization.',
          tomato: 'Tomatoes are sensitive to overwatering.'
        }
      };

      const adv_kn = {
        water_low: '‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂ ‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü ‡≤á‡≤¶‡≥Ü. ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤ó‡≥Ü ‡≤á‡≤µ‡≤§‡≥ç‡≤§‡≥Å 15 ‡≤®‡≤ø‡≤Æ‡≤ø‡≤∑ ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤ï‡≥ä‡≤°‡≤ø‡≤∞‡≤ø. ',
        water_high: '‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂ ‡∞Ö‡∞ß‡≤ø‡≤ï‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü. ‡≤ú‡≤≤‡≤®‡§ø‡§∞‡≥ã‡≤ß‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤°‡≥Ü‡≤Ø‡≤≤‡≥Å ‡≤®‡≥Ä‡≤∞‡≥Å‡≤°‡≤ø‡≤∏‡≥Å‡≤µ‡≥Å‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤™‡≥ç‡≤™‡≤ø‡≤∏‡≤ø. ',
        water_ok: '‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂ ‡≤∏‡≤Æ‡≤∞‡≥ç‡≤™‡≤ï‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü. ‡≤à‡≤ó ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤π‡≤æ‡≤ï‡≥Å‡≤µ ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤. ',
        nutrient_low: '‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ã‡≤∑‡≤ï‡≤æ‡≤Ç‡≤∂ ‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü ‡≤á‡≤¶‡≥Ü. ‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø‡≤ï‡≥ç‡≤ï‡≥Ü ‡≤Ö‡≤®‡≥Å‡≤ó‡≥Å‡≤£‡≤µ‡≤æ‡≤ó‡≤ø ‡≤â‡≤™‡≤™‡≥ã‡≤∑‡≤£‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤∞‡≤ø. ',
        nutrient_ok: '‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ã‡≤∑‡≤ï‡≤æ‡≤Ç‡≤∂ ‡≤∏‡≤Æ‡≤∞‡≥ç‡≤™‡≤ï‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü. ‡≤à‡≤ó ‡≤â‡≤™‡≤™‡≥ã‡≤∑‡≤£‡≥Ü‡≤Ø ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤. ',
        temp_low: '‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤® ‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü ‡≤á‡≤¶‡≥Ü. ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤¶‡≤ø‡≤∞‡≥Å‡≤µ ‡≤ó‡≤ø‡≤°‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤Ç‡≤™‡≤ø‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤∞‡≤ï‡≥ç‡≤∑‡≤ø‡≤∏‡≤ø. ',
        temp_high: '‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤® ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å ‡≤á‡≤¶‡≥Ü. ‡≤π‡≤æ‡≤®‡≤ø ‡≤§‡≤™‡≥ç‡≤™‡≤ø‡≤∏‡≤≤‡≥Å ‡≤®‡≥Ü‡≤∞‡≤≥‡≥Ü ‡≤Ö‡≤•‡≤µ‡≤æ ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤®‡≥Ä‡≤°‡≤ø‡≤∞‡≤ø. ',
        temp_ok: '‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤® ‡≤¨‡≥Ü‡≤≥‡≤µ‡≤£‡≤ø‡≤ó‡≥Ü‡≤Ø ‡≤Ö‡≤®‡≥Å‡≤ï‡≥Ç‡≤≤‡≤ï‡≤∞ ‡≤∂‡≥ç‡≤∞‡≥á‡≤£‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø‡≤¶‡≥Ü. ',
        weather_rainy: '‡≤Æ‡≤≥‡≥Ü ‡≤®‡≤ø‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü. ‡≤®‡≥Ä‡≤∞‡≥Å‡≤°‡≤ø‡≤∏‡≥Å‡≤µ‡≤ø‡≤ï‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤µ‡≤ø‡≤≥‡≤Ç‡≤¨‡≤Æ‡≤æ‡≤°‡≤ø ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤Æ‡≤≥‡≥Ü‡≤Ø‡≤ø‡≤Ç‡≤¶ ‡≤®‡≤Ç‡≤§‡≤∞ ‡≤ï‡≥Ä‡≤ü‡≤ó‡≤≥ ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤®‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø. ',
        weather_dry: '‡≤¨‡≤ø‡≤≤‡≥ç‡≤≤‡≥Å ‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤®‡≤ø‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü. ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤∏‡≤Æ‡≥Ä‡≤™‡≤¶‡≤ø‡≤Ç‡≤¶ ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤ø. ',
        crop_notes: {
          maize: '‡≤Æ‡≥Ü‡≤ï‡≥ç‡≤ï‡≥Ü‡≤ú‡≥ã‡≤≥ ‡≤¨‡≥Ü‡≤≥‡≤µ‡≤£‡≤ø‡≤ó‡≥Ü‡≤Ø ‡≤π‡≤Ç‡≤§‡≤ó‡≤≥‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≤ø‡≤Ø‡≤Æ‡≤ø‡≤§ ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤®‡≥Ü ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø‡≤µ‡≤ø‡≤¶‡≥Ü.',
          rice: '‡≤Ö‡≤®‡≥ç‡≤® ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤ó‡≤≥‡≤ø‡≤ó‡≥Ü ‡≤ú‡≤æ‡≤ó‡≤∞‡≥Ç‡≤ï ‡≤®‡≥Ä‡≤∞‡≤ø‡≤® ‡≤®‡≤ø‡≤∞‡≥ç‡≤µ‡≤π‡≤£‡≥Ü ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø. ',
          beans: '‡≤¨‡≥Ä‡≤®‡≥ç‡≤∏‡≥ç ‡≤∏‡≤Æ‡≤§‡≥ã‡≤≤‡≤® ‡≤™‡≥ã‡≤∑‡≤£‡≥Ü‡≤Ø‡≤ø‡≤Ç‡≤¶ ‡≤™‡≥ç‡≤∞‡≤Ø‡≥ã‡≤ú‡≤® ‡≤™‡≤°‡≥Ü‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü. ',
          tomato: '‡≤ü‡≥ä‡≤Æ‡≥á‡≤ü‡≥ã‡≤ó‡≤≥‡≥Å ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≤ø‡≤® ‡≤®‡≥Ä‡≤∞‡≤ø‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤∏‡≤Ç‡≤µ‡≥á‡≤¶‡≤®‡≤∂‡≥Ä‡≤≤‡≤µ‡≤æ‡≤ó‡≤ø‡≤µ‡≥Ü.'
        }
      };

      const adv = lang === 'kn' ? adv_kn : adv_en;

      let advice = '';

      // Watering advice
      if (moisture < 30) {
        advice += adv.water_low;
      } else if (moisture > 70) {
        advice += adv.water_high;
      } else {
        advice += adv.water_ok;
      }

      // Fertilization advice
      if (nutrients < 40) {
        advice += adv.nutrient_low;
      } else {
        advice += adv.nutrient_ok;
      }

      // Temperature advice
      if (temperature < 15) {
        advice += adv.temp_low;
      } else if (temperature > 35) {
        advice += adv.temp_high;
      } else {
        advice += adv.temp_ok;
      }

      // Weather-based advice
      if (weather === 'rainy') {
        advice += adv.weather_rainy;
      } else if (weather === 'dry') {
        advice += adv.weather_dry;
      }

      // Crop-specific note
      if (adv.crop_notes[crop]) {
        advice += adv.crop_notes[crop];
      }

      return advice;
    }

    getAdviceBtn.addEventListener('click', () => {
      const adviceText = generateAdvice();
      adviceDiv.textContent = adviceText;
      adviceDiv.style.display = 'block';
      speakBtn.disabled = false;
    });

    speakBtn.addEventListener('click', () => {
      const text = adviceDiv.textContent;
      if ('speechSynthesis' in window) {
        const lang = languageSelect.value === 'kn' ? 'kn-IN' : 'en-US';
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = lang;

        const voices = window.speechSynthesis.getVoices();
        
        // For Kannada voice, attempt to find a voice with language "kn" or "kn-IN"
        let voice = null;
        if (lang === 'kn-IN') {
          voice = voices.find(v => v.lang.toLowerCase().startsWith('kn'));
        }
        if (!voice) {
          // Fallback: English US voice
          voice = voices.find(v => v.lang.startsWith('en-US')) || voices[0];
        }
        if (voice) {
          utterance.voice = voice;
        }

        window.speechSynthesis.speak(utterance);
      } else {
        alert(languageSelect.value === 'kn' ?
          '‡≤ï‡≥ç‡≤∑‡≤Æ‡≤ø‡≤∏‡≤ø, ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤¨‡≥ç‡≤∞‡≥å‡≤∏‡≤∞‡≥ç ‡≤ß‡≥ç‡≤µ‡≤®‡≤ø‡≤∏‡≤ø‡≤Ç‡≤•‡≥Ü‡≤∏‡≤ø‡≤∏‡≥ç ‡≤Ö‡≤®‡≥ç‡≤®‡≥Å ‡≤¨‡≥Ü‡≤Ç‡≤¨‡≤≤‡≤ø‡≤∏‡≥Å‡≤µ‡≥Å‡≤¶‡≤ø‡≤≤‡≥ç‡≤≤.' :
          'Sorry, your browser does not support speech synthesis.'
        );
      }
    });

    // Initialize page text for default language (English)
    updateLanguageTexts('en');
  </script>
</body>
</html>